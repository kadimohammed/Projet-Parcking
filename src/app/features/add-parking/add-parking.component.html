<!-- Content -->
<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Forms/</span> Add New Parking</h4>

    <!-- Basic Layout -->
    <div class="row">
        <div class="col-xl">
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Add Parking</h5>
                </div>
                <div class="card-body">
                    <form [formGroup]="addParkingForm" (ngSubmit)="onSubmit()">
                        <div class="mb-3">
                            <label class="form-label" for="nomParcking">Name</label>
                            <div class="input-group input-group-merge">
                                <span id="nameIcon" class="input-group-text"><i class='bx bxs-parking'></i></span>
                                <input type="text" class="form-control" id="nomParcking"
                                       placeholder="Name"
                                       formControlName="nomParcking"/>
                            </div>
                            <div *ngIf="addParkingForm.get('nomParcking')?.invalid && (addParkingForm.get('nomParcking')?.dirty || addParkingForm.get('nomParcking')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('nomParcking')?.errors?.['required']">Name is required.</div>
                                <div *ngIf="addParkingForm.get('nomParcking')?.errors?.['minlength']">Name must be at least 3 characters long.</div>
                                <div *ngIf="addParkingForm.get('nomParcking')?.errors?.['maxlength']">Name cannot be more than 100 characters long.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="latitude">Latitude</label>
                            <div class="input-group input-group-merge">
                                <span id="latitudeIcon" class="input-group-text"><i class='bx bx-current-location'></i></span>
                                <input type="number" class="form-control" id="latitude"
                                       placeholder="Latitude"
                                       formControlName="latitude"/>
                            </div>
                            <div *ngIf="addParkingForm.get('latitude')?.invalid && (addParkingForm.get('latitude')?.dirty || addParkingForm.get('latitude')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('latitude')?.errors?.['required']">Latitude is required.</div>
                                <div *ngIf="addParkingForm.get('latitude')?.errors?.['pattern']">Latitude must be a valid number.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="longitude">Longitude</label>
                            <div class="input-group input-group-merge">
                                <span id="longitudeIcon" class="input-group-text"><i class='bx bx-current-location'></i></span>
                                <input type="number" class="form-control" id="longitude"
                                       placeholder="Longitude"
                                       formControlName="longitude"/>
                            </div>
                            <div *ngIf="addParkingForm.get('longitude')?.invalid && (addParkingForm.get('longitude')?.dirty || addParkingForm.get('longitude')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('longitude')?.errors?.['required']">Longitude is required.</div>
                                <div *ngIf="addParkingForm.get('longitude')?.errors?.['pattern']">Longitude must be a valid number.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="adresse">Address</label>
                            <div class="input-group input-group-merge">
                                <span id="adresseIcon" class="input-group-text"><i class='bx bxs-location-plus'></i></span>
                                <input type="text" id="adresse" class="form-control"
                                       placeholder="Address"
                                       formControlName="adresse"/>
                            </div>
                            <div *ngIf="addParkingForm.get('adresse')?.invalid && (addParkingForm.get('adresse')?.dirty || addParkingForm.get('adresse')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('adresse')?.errors?.['required']">Address is required.</div>
                                <div *ngIf="addParkingForm.get('adresse')?.errors?.['minlength']">Address must be at least 5 characters long.</div>
                                <div *ngIf="addParkingForm.get('adresse')?.errors?.['maxlength']">Address cannot be more than 100 characters long.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="surface">Surface</label>
                            <div class="input-group input-group-merge">
                                <span id="surfaceIcon" class="input-group-text"><i class='bx bx-space-bar'></i></span>
                                <input type="number" id="surface" class="form-control"
                                       placeholder="Surface"
                                       formControlName="surface"/>
                            </div>
                            <div *ngIf="addParkingForm.get('surface')?.invalid && (addParkingForm.get('surface')?.dirty || addParkingForm.get('surface')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('surface')?.errors?.['required']">Surface is required.</div>
                                <div *ngIf="addParkingForm.get('surface')?.errors?.['min']">Surface must be at least 50.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="timeStartWork">Time Start Work</label>
                            <div class="input-group input-group-merge">
                                <span id="timeStartWorkIcon" class="input-group-text"><i class='bx bxs-time'></i></span>
                                <input type="time" id="timeStartWork" class="form-control"
                                       placeholder="Time Start Work"
                                       formControlName="timeStartWork"/>
                            </div>
                            <div *ngIf="addParkingForm.get('timeStartWork')?.invalid && (addParkingForm.get('timeStartWork')?.dirty || addParkingForm.get('timeStartWork')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('timeStartWork')?.errors?.['required']">Time Start Work is required.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="timeEndWork">Time End Work</label>
                            <div class="input-group input-group-merge">
                                <span id="timeEndWorkIcon" class="input-group-text"><i class='bx bxs-time'></i></span>
                                <input type="time" id="timeEndWork" class="form-control"
                                       placeholder="Time End Work"
                                       formControlName="timeEndWork"/>
                            </div>
                            <div *ngIf="addParkingForm.get('timeEndWork')?.invalid && (addParkingForm.get('timeEndWork')?.dirty || addParkingForm.get('timeEndWork')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('timeEndWork')?.errors?.['required']">Time End Work is required.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="creationDate">Creation Date</label>
                            <div class="input-group input-group-merge">
                                <span id="creationDateIcon" class="input-group-text"><i class='bx bxs-calendar'></i></span>
                                <input type="date" id="creationDate" class="form-control"
                                       placeholder="Creation Date"
                                       formControlName="creationDate"/>
                            </div>
                            <div *ngIf="addParkingForm.get('creationDate')?.invalid && (addParkingForm.get('creationDate')?.dirty || addParkingForm.get('creationDate')?.touched)" class="form-text">
                                <div *ngIf="addParkingForm.get('creationDate')?.errors?.['required']">Creation Date is required.</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="formFileMultiple" class="form-label">Upload Parking Photos (at least one photo required)</label>
                            <input class="form-control" type="file" id="formFileMultiple" (change)="onFileChange($event)" multiple>
                            <div *ngIf="addParkingForm.get('photoParkings')?.invalid" class="form-text">
                                <div *ngIf="addParkingForm.get('photoParkings')?.errors?.['required']">At least one photo is required.</div>
                                <div *ngIf="addParkingForm.get('photoParkings')?.errors?.['invalidFiles']">
                                    <div *ngFor="let error of addParkingForm.get('photoParkings')?.errors?.['invalidFiles'].errors">{{ error }}</div>
                                </div>
                            </div>
                        </div>


                        <div *ngIf="addParkingForm.get('photoParkings')?.valid && uploadedImages.length > 0" class="row mb-5">
                            <div *ngFor="let img of uploadedImages; let i = index" class="col-md-6 col-lg-4 mb-3">
                                <div class="card h-100">
                                    <img class="card-img-top" [src]="img" alt="Uploaded Image" width="100">
                                    <div class="card-body">
                                        <h3 class="imageTitle">{{ uploadedFileNames[i] }}</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                        

                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="isWorking"
                                   formControlName="isWorking"/>
                            <label class="form-check-label" for="isWorking">Parking Is Working</label>
                        </div>

                        <button type="submit" class="btn btn-primary" [disabled]="addParkingForm.invalid">Add Parking</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
